<template>
    <div class={wrapperCss}>
        <template if:true={isReady}>

            <!-- KPI List Display -->
            <template if:true={kpiList}>
                <lightning-layout multiple-rows horizontal-align="center" vertical-align="center">
                    <template for:each={kpiList} for:item="iter">
                        <lightning-layout-item key={iter.name} padding="around-small">
                            <div class={iter.class} data-kpi-value={iter.value} >
                                <div class="slds-theme_default kpiValue kpiAction" data-kpi-name={iter.name} onclick={handleKpiClick} >
                                    <!--
                                    <lightning-formatted-number value={iter.value}      title={iter.value}
                                                                format-style="decimal"  
                                                                class="slds-text-heading_medium kpiNumber">
                                    </lightning-formatted-number>
                                    -->
                                    <p class="slds-text-heading_medium kpiNumber" title={iter.valueFull}>{iter.value}</p>
                                </div>
                                <div class="kpiIcon kpiAction" data-kpi-name={iter.name} onclick={handleKpiClick}>
                                    <lightning-icon icon-name={iter.icon}   size="medium"
                                                    title={iter.name}>
                                    </lightning-icon>
                                </div>
                            </div>
                        </lightning-layout-item>
                    </template>

                    <!-- Refresh Button display -->
                    <template if:true={showRefresh}>
                        <lightning-layout-item padding="around-small">
                            <lightning-button-icon  icon-name="utility:refresh" 
                                                    size="small"    variant="border-filled"
                                                    onclick={handleRefresh}>
                            </lightning-button-icon>
                        </lightning-layout-item>
                    </template>

                </lightning-layout>
            </template>

            <!-- Error Message Display -->
            <template if:true={errorMessage}>
                <div class="slds-media slds-media_center slds-m-vertical_x-small slds-p-horizontal_x-small headerContainer">
                    <div class="slds-media__figure">
                        <lightning-icon icon-name="utility:error" size="x-small"
                                        variant="error">
                        </lightning-icon>
                    </div>
                    <div class="slds-media__body">
                        <lightning-formatted-text   value={errorMessage}    class="slds-text-color_error">
                        </lightning-formatted-text>
                    </div>
                </div>
            </template>
        </template>

        <!-- Init Spinner Display -->
        <template if:false={isReady}>
            <lightning-spinner alternative-text="Initializing..." size="medium">
            </lightning-spinner>
        </template>

        <!-- Loading Spinner Display -->
        <template if:true={isLoading}>
            <lightning-spinner alternative-text="Loading..." size="medium">
            </lightning-spinner>
        </template>

        <!-- Debug info Display -->
        <template if:true={isDebug}>
            <div class="slds-box slds-theme_default slds-text-color_default slds-m-top_x-small">
                <dl class="slds-dl_horizontal slds-text-align_left">
                    <dt class="slds-dl_horizontal__label slds-truncate">KPI #1:</dt>
                    <dd class="slds-dl_horizontal__detail">{relList1}</dd>
                    <dt class="slds-dl_horizontal__label slds-truncate">KPI #2:</dt>
                    <dd class="slds-dl_horizontal__detail">{relList2}</dd>
                    <dt class="slds-dl_horizontal__label slds-truncate">KPI #3:</dt>
                    <dd class="slds-dl_horizontal__detail">{relList3}</dd>
                    <dt class="slds-dl_horizontal__label slds-truncate">KPI #4:</dt>
                    <dd class="slds-dl_horizontal__detail">{relList4}</dd>
                    <dt class="slds-dl_horizontal__label slds-truncate">KPI #5:</dt>
                    <dd class="slds-dl_horizontal__detail">{relList5}</dd>
                    <dt class="slds-dl_horizontal__label slds-truncate">KPI #6:</dt>
                    <dd class="slds-dl_horizontal__detail">{relList6}</dd>
                    <dt class="slds-dl_horizontal__label slds-truncate">Documentation:</dt>
                    <dd class="slds-dl_horizontal__detail">
                        <lightning-formatted-url    value="https://github.com/pegros/PEG_MISC"
                                                    label="See Help on GitHub"
                                                    target="_blank">
                        </lightning-formatted-url>
                    </dd>
                </dl>
            </div>
        </template>
    </div>
</template>